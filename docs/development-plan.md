# 可愛い声スイートスポット探索アプリケーション 開発計画書

## プロジェクト概要
デスクトップ向け音声処理アプリケーションとして、Python + PyWorld + PySide6を使用して開発します。

## 開発フェーズ

### Phase 1: コア音声処理機能（完了済み）
**期間**: 1週間  
**状態**: ✅ 完了

**実装内容**:
- ✅ `kawaii_voice_core.py` - 音声処理コアモジュール
  - AudioProcessor クラス（PyWorld統合）
  - AudioPlayer クラス（sounddevice統合）
  - プリセット定義
- ✅ ファイル読み込みとPyWorld分析
- ✅ F0（ピッチ）変更機能
- ✅ フォルマントシフト機能（基本実装）
- ✅ ループ再生機能

### Phase 2: GUI実装（開発予定）
**期間**: 1週間  
**状態**: 🔄 次の実装

**実装予定**:
- `kawaii_voice_gui.py` - PySide6 GUIモジュール
  - メインウィンドウデザイン
  - パラメータスライダー（F0, F1-F3）
  - ファイルドラッグ&ドロップ
  - プリセット選択UI
  - 再生コントロール
- `kawaii_voice_widgets.py` - カスタムウィジェット
  - 波形表示ウィジェット
  - スペクトラム表示ウィジェット
  - パラメータ値表示

### Phase 3: 統合と最適化（開発予定）
**期間**: 3日  
**状態**: ⏳ 待機中

**実装予定**:
- `kawaii_voice_app.py` - メインアプリケーション
  - コアとGUIの統合
  - スレッド管理
  - エラーハンドリング
- パフォーマンス最適化
  - バッファサイズ調整
  - メモリ使用量最適化
  - CPU使用率改善

### Phase 4: パッケージングと配布（開発予定）
**期間**: 3日  
**状態**: ⏳ 待機中

**実装予定**:
- PyInstallerスクリプト作成
- 各OS向けビルド設定
  - Windows (.exe)
  - macOS (.app)
  - Linux (AppImage)
- インストーラー作成
- ドキュメント整備

## 技術的な実装詳細

### アーキテクチャ
```
┌─────────────────────────────────────────┐
│         GUI Layer (PySide6)             │
│  - メインウィンドウ                     │
│  - パラメータコントロール               │
│  - 視覚化ウィジェット                   │
└────────────────┬────────────────────────┘
                 │
┌────────────────┴────────────────────────┐
│      Core Processing Layer              │
│  - AudioProcessor (PyWorld)             │
│  - AudioPlayer (sounddevice)            │
│  - プリセット管理                       │
└────────────────┬────────────────────────┘
                 │
┌────────────────┴────────────────────────┐
│        I/O Layer                        │
│  - soundfile (ファイル読み込み)         │
│  - sounddevice (音声出力)               │
└─────────────────────────────────────────┘
```

### スレッド設計
1. **メインスレッド**: GUI イベント処理
2. **音声処理スレッド**: PyWorld分析・合成
3. **再生スレッド**: sounddeviceコールバック

### データフロー
1. ファイル読み込み → PyWorld分析（1回のみ）
2. パラメータ変更 → キャッシュ無効化
3. 再生要求 → キャッシュ確認 → 必要なら再合成
4. sounddevice → スピーカー出力

## リスク管理

### 技術的リスク
| リスク | 対策 | 状態 |
|--------|------|------|
| PyWorldのリアルタイム制限 | ハイブリッドアプローチ実装済み | ✅ 解決 |
| GUI応答性の低下 | マルチスレッド設計 | 🔄 実装中 |
| 大容量ファイルのメモリ使用 | セグメント処理（Phase 3） | ⏳ 待機中 |

### スケジュールリスク
- **Phase 2 遅延リスク**: 中
  - 対策: GUI機能を段階的に実装
- **Phase 4 遅延リスク**: 低
  - 対策: 早期にビルドテスト開始

## 成果物

### ソースコード
- ✅ `kawaii_voice_core.py`
- 🔄 `kawaii_voice_gui.py`
- ⏳ `kawaii_voice_widgets.py`
- ⏳ `kawaii_voice_app.py`

### ドキュメント
- ✅ `requirements-specification.md`
- ✅ `technical-selection.md`
- ✅ `kawaii-voice-research-report.md`
- ✅ `real-time-audio-processing-comparison.md`
- ✅ `development-plan.md`
- ⏳ ユーザーマニュアル
- ⏳ API ドキュメント

### 配布物
- ⏳ Windows インストーラー
- ⏳ macOS dmg ファイル
- ⏳ Linux AppImage

## 次のアクション

1. **Phase 2 開始準備**
   - PySide6 の詳細設計
   - UIモックアップ作成
   - ウィジェットクラス設計

2. **テスト音声の準備**
   - 様々な音声サンプル収集
   - テストケース定義

3. **開発環境の最終確認**
   - 依存関係の固定
   - CI/CD パイプライン検討