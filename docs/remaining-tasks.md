# 残タスク一覧

最終更新日: 2025-01-13

## 概要

Kawaii Voice Changerの基本的な音声処理機能は実装済みですが、ユーザビリティの向上と高度な機能の実装が残っています。本ドキュメントでは、残っているタスクを優先度別に整理しています。

## タスク一覧

### 🔴 優先度：高（コア機能）

#### 1. スペクトログラム/スペクトラム表示機能
- **説明**: リアルタイムで音声の周波数成分を可視化
- **詳細**:
  - FFT解析によるリアルタイム周波数表示
  - フォルマント周波数（F1, F2, F3）のマーカー表示
  - 処理前後の比較表示
- **技術要件**:
  - pyqtgraphを使用した高速描画
  - 512〜2048ポイントのFFT
  - 20〜60fps程度の更新レート
- **影響範囲**: GUI、音声処理モジュール

#### 2. A/B比較機能
- **説明**: オリジナル音声と処理済み音声をワンクリックで切り替え
- **詳細**:
  - トグルボタンでの瞬時切り替え
  - 切り替え時のクリックノイズ防止
  - 視覚的なインジケーター
- **技術要件**:
  - AudioProcessorクラスの拡張
  - バイパスモードの実装
- **影響範囲**: GUI、AudioProcessor、AudioPlayer

#### 3. 音声エクスポート機能
- **説明**: 処理済み音声をファイルとして保存
- **詳細**:
  - WAV形式（16bit/24bit）での出力
  - メタデータ（使用パラメータ）の埋め込み
  - バッチ処理対応（将来的に）
- **技術要件**:
  - soundfileライブラリの使用
  - 非同期処理での実装
- **影響範囲**: メニューバー、AudioProcessor

### 🟡 優先度：中（機能改善）

#### 4. 独立フォルマントモード改善
- **説明**: 各フォルマント周波数を個別に適切に処理
- **現状**: `audio_processor.py:211` - 平均値を使用（TODO: improve）
- **詳細**:
  - F1, F2, F3それぞれに異なる比率を適用
  - より自然な音声変換アルゴリズム
- **技術要件**:
  - スペクトル包絡の精密な操作
  - フォルマント検出アルゴリズムの改善
- **影響範囲**: AudioProcessorクラス

#### 5. プリセット保存機能
- **説明**: カスタムプリセットの作成と管理
- **現状**: `main_window.py:395` - 未実装メッセージを表示（TODO）
- **詳細**:
  - プリセット保存ダイアログ
  - JSON形式でのエクスポート/インポート
  - プリセットの編集・削除機能
- **技術要件**:
  - QDialogの実装
  - プリセットファイルの管理
- **影響範囲**: GUI、設定管理

#### 6. ループ領域選択機能
- **説明**: 音声ファイルの任意区間をループ再生
- **詳細**:
  - 波形表示上でのビジュアル選択
  - ループイン/アウトポイントの設定
  - 選択範囲のプレビュー
- **技術要件**:
  - WaveformDisplayの拡張
  - マウスイベントハンドリング
- **影響範囲**: WaveformDisplay、AudioPlayer

#### 7. 複数設定スロット
- **説明**: 最大4つの異なる設定を保存・比較
- **詳細**:
  - スロット切り替えUI
  - 設定のコピー/ペースト
  - A/B/C/D比較モード
- **技術要件**:
  - 設定管理システムの拡張
  - メモリ効率的な実装
- **影響範囲**: GUI全体、設定管理

### 🟢 優先度：低（UX改善）

#### 8. ループポイントのクロスフェード
- **説明**: スムーズなループ再生のための音声処理
- **詳細**:
  - 10〜50ms可変のクロスフェード時間
  - 線形/対数カーブの選択
- **技術要件**:
  - AudioPlayerクラスの拡張
  - リアルタイムクロスフェード処理
- **影響範囲**: AudioPlayer

#### 9. キーボードショートカット拡充
- **説明**: 効率的な操作のためのショートカット追加
- **詳細**:
  - Space: 再生/一時停止
  - R: パラメータリセット
  - 1-5: プリセット切り替え
  - Ctrl+E: エクスポート
- **技術要件**:
  - QShortcutの実装
  - ショートカット設定画面
- **影響範囲**: MainWindow

#### 10. パラメータ変更の視覚フィードバック
- **説明**: スライダー操作時の視覚的な反応
- **詳細**:
  - 変更時のハイライト効果
  - アニメーション付き値変更
  - ツールチップでの数値表示
- **技術要件**:
  - カスタムスライダーウィジェット
  - Qt Animationフレームワーク
- **影響範囲**: ParameterSlider

#### 11. パラメータ値の永続化
- **説明**: アプリケーション終了時の設定保存
- **詳細**:
  - 最後に使用したパラメータ値の復元
  - プロジェクトファイル形式での保存
- **技術要件**:
  - Configクラスの拡張
  - 自動保存機能
- **影響範囲**: Config、MainWindow

#### 12. 最近使ったファイルの改善
- **説明**: 存在しないファイルの適切な処理
- **詳細**:
  - ファイル存在チェック
  - 無効なエントリのグレーアウト
  - リストのクリーンアップ機能
- **技術要件**:
  - 非同期ファイルチェック
  - メニューの動的更新
- **影響範囲**: MainWindow、Config

## 実装順序の推奨

1. **フェーズ1（基本機能完成）**
   - A/B比較機能
   - 音声エクスポート機能
   - プリセット保存機能

2. **フェーズ2（視覚化強化）**
   - スペクトログラム表示
   - ループ領域選択
   - パラメータ変更フィードバック

3. **フェーズ3（高度な機能）**
   - 独立フォルマントモード改善
   - 複数設定スロット
   - クロスフェード実装

4. **フェーズ4（仕上げ）**
   - キーボードショートカット
   - 設定の永続化
   - UIの細かい改善

## 技術的考慮事項

### パフォーマンス
- スペクトログラム表示は計算負荷が高いため、別スレッドでの処理を検討
- 複数設定スロットではメモリ使用量に注意

### 互換性
- 音声エクスポート機能は各プラットフォームでのコーデック対応を確認
- キーボードショートカットはOS固有の慣習に従う

### テスト
- 各機能追加時には対応するユニットテストを作成
- UIテストの自動化も検討

## 見積もり工数

- 優先度高タスク: 約2-3週間
- 優先度中タスク: 約3-4週間  
- 優先度低タスク: 約2週間
- **合計**: 約7-9週間（フルタイム開発の場合）

## 関連ドキュメント

- [要件定義書](requirements-specification.md)
- [技術選定書](technical-selection.md)
- [開発計画書](development-plan.md)